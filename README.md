# üçΩÔ∏è API-—Å–µ—Ä–≤–∏—Å –∑–∞–∫–∞–∑–æ–≤ –µ–¥—ã –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ

REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ –µ–¥—ã –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ. –°–µ—Ä–≤–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ –æ—Ç–º–µ–Ω—è—Ç—å –∑–∞–∫–∞–∑—ã, –∞ —Ç–∞–∫–∂–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –º–µ–Ω—é –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –±–ª—é–¥–∞–º–∏.

## üìã –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö:
- **Dish** (–ë–ª—é–¥–æ): id, name, description, price, category
- **Order** (–ó–∞–∫–∞–∑): id, customer_name, dishes (Many-to-Many), order_time, status

### API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `GET /api/v1/dishes/` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–ª—é–¥
- `POST /api/v1/dishes/` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –±–ª—é–¥–æ
- `DELETE /api/v1/dishes/{id}` ‚Äî —É–¥–∞–ª–∏—Ç—å –±–ª—é–¥–æ
- `GET /api/v1/orders/` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
- `POST /api/v1/orders/` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑
- `DELETE /api/v1/orders/{id}` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑
- `PATCH /api/v1/orders/{id}/status` ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker
- Docker Compose
- Python 3.11+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- Poetry (–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏)

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd restaurant_order_service
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
cd deploy
docker-compose up --build
```

3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000

4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:
   - **Swagger UI**: http://localhost:8000/docs
   - **ReDoc**: http://localhost:8000/redoc

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–∑ Docker:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
poetry install
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ —Å–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª

3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
poetry run alembic upgrade head
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
poetry run python -m src
```

### –†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏

–ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é:

```bash
# –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker exec -it restaurant_app bash

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head

# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é (–ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π)
alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ api/v1/
‚îÇ   ‚îú‚îÄ‚îÄ routers/          # API —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ models/               # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas/              # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ repositories/         # –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ database.py          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
‚îî‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **FastAPI** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Poetry** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- **SQLAlchemy** ‚Äî ORM
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Alembic** ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- **Docker** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- **Pydantic** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- **Uvicorn** ‚Äî ASGI —Å–µ—Ä–≤–µ—Ä

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```env
# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
DB_URL=postgresql+asyncpg://restaurant_user:restaurant_password@localhost:5432/restaurant_db
MODE=DEV

# –î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
# DISABLE_DOCS=true
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í Docker Compose –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–æ–≤

1. "–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ" (processing)
2. "–≥–æ—Ç–æ–≤–∏—Ç—Å—è" (cooking)
3. "–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è" (delivering)
4. "–∑–∞–≤–µ—Ä—à–µ–Ω" (completed)
5. "–æ—Ç–º–µ–Ω–µ–Ω" (cancelled)

–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Å—Ç–∞—Ç—É—Å–µ "–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ".

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: "Port 5432 is already allocated"
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π PostgreSQL –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ docker-compose.yml
sudo service postgresql stop
# –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 5433:5432)
```

### –ü—Ä–æ–±–ª–µ–º–∞: "404 Not Found" –Ω–∞ /docs
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `MODE=DEV` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –ü—Ä–æ–±–ª–µ–º–∞: "Connection refused"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã: `docker-compose ps`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç `0.0.0.0:8000`, –∞ –Ω–µ `127.0.0.1:8000`

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
cd deploy
docker-compose logs web    # –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs db     # –õ–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

---

<details>
<summary><b>–°–≤—è–∑–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π</b></summary>
<p align="left">
  <a href="mailto:pafos.light@gmail.com">
    <img src="https://img.shields.io/badge/Gmail-%23EA4335.svg?style=plastic&logo=gmail&logoColor=white" alt="Gmail"/>
  </a>
  <a href="https://t.me/petr_lip">
    <img src="https://img.shields.io/badge/Telegram-0088CC?style=plastic&logo=telegram&logoColor=white" alt="Telegram"/>
  </a>
</p>
</details>